var R=Object.defineProperty;var C=(i,e,t)=>e in i?R(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t;var l=(i,e,t)=>(C(i,typeof e!="symbol"?e+"":e,t),t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const a of r.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function t(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerPolicy&&(r.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?r.credentials="include":s.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function n(s){if(s.ep)return;s.ep=!0;const r=t(s);fetch(s.href,r)}})();let y={required:"This field is required.",minLength:"Please enter at least {0} characters.",maxLength:"Please enter max {0} characters.",range:"Please enter a value between {0} and {1}.",rangelength:"Please enter a value between {0} and {1} characters long.",email:"Please enter a valid email address.",url:"Please enter a valid URL.",digits:"Please enter only digits.",equalTo:"Please enter the same value again.",max:"Please enter a value less than or equal to {0}.",min:"Please enter a value greater than or equal to {0}."};class u{static addRule(e,t,n){this.validators.set(e,{validator:t,errorText:n,index:this.index}),this.index++,n&&this.messages.set(e,n)}static setRuleMessages(e){for(let t in e)this.messages.set(t,e[t])}}l(u,"validators",new Map),l(u,"messages",new Map),l(u,"index",0);u.setRuleMessages(y);function d(i){console.warn("input-validation-next: "+i)}function h(i){return i&&typeof i=="object"&&!Array.isArray(i)}function E(i,e){let t=Object.assign({},i);return h(i)&&h(e)&&Object.keys(e).forEach(n=>{h(e[n])?n in i?t[n]=E(i[n],e[n]):Object.assign(t,{[n]:e[n]}):Object.assign(t,{[n]:e[n]})}),t}let p=u.validators;class N{constructor(e,t){l(this,"inputRulesNames",[]);l(this,"inputRulesMessages");l(this,"inputConfigRules");l(this,"inputNode");l(this,"mergedConfig");l(this,"needValidation",!0);l(this,"isValid",!1);l(this,"invalidRule","");l(this,"invalidRuleMessage","");l(this,"inputName","");l(this,"initRules",e=>{for(const t in e)switch(p.get(t)?(this.inputRulesNames.push(t),this.inputConfigRules[t]=e[t]):d(`rule param '${t}' doesn't exist with value '${e[t]}'`),t){case"required":typeof e[t]!="boolean"&&d(`rule param '${t}' isn't boolean with value '${e[t]}'`);break;case"minLegnth":case"maxLegnth":typeof e[t]!="number"&&d(`rule param '${t}' isn't number with value '${e[t]}'`);break}});l(this,"inputEvent",()=>{this.validate()});var n,s;this.inputNode=e,this.inputName=this.inputNode.getAttribute("name")||"",this.inputConfigRules=((n=t.rules)==null?void 0:n[this.inputName])||{},this.inputRulesMessages=((s=t.messages)==null?void 0:s[this.inputName])||{},this.mergedConfig=t,e.classList.add(this.mergedConfig.inputElementClass),e.getAttributeNames().forEach(r=>{let a;switch(r){case"required":this.inputConfigRules.required=!0;break;case"min-length":a=e.getAttribute(r),a&&(this.inputConfigRules.minLength=+a);break;case"max-length":a=e.getAttribute(r),a&&(this.inputConfigRules.maxLength=+a);break}}),this.initRules(this.inputConfigRules),this.inputRulesNames.sort((r,a)=>{var b,v;let f=(b=p.get(r))==null?void 0:b.index,o=(v=p.get(a))==null?void 0:v.index;return f<o?-1:1}),this.inputNode.getAttribute("type")==="radio"&&document.querySelectorAll(`input[name='${this.inputName}']`).forEach(r=>{r.addEventListener("input",this.inputEvent)}),this.inputRulesNames.length===0?this.needValidation=!1:this.setInputValidationEvents()}removeRules(e){e?this.inputRulesNames=this.inputRulesNames.filter(t=>!e.includes(t)):this.inputRulesNames=[]}addRules(e){if(this.initRules(e.rules),e.messages)for(let t in e.messages){let n=e.messages[t];this.inputRulesMessages[t]=n}}setInputValidationEvents(){this.inputNode.addEventListener("focusout",this.inputEvent),this.inputNode.addEventListener("input",this.inputEvent)}destroy(){this.inputNode.removeEventListener("focusout",this.inputEvent),this.inputNode.removeEventListener("input",this.inputEvent)}validate(e=!0){let t=this.inputNode.value,n=!0;if(this.inputRulesNames.every(s=>{var a;let r=this.inputConfigRules[s];if(!((a=p.get(s))!=null&&a.validator(t,r||null,this.inputNode))&&(n=!1,!n&&e)){let f=this.inputNode.parentElement.querySelector("."+this.mergedConfig.errorElementClass);this.inputNode.classList.remove(this.mergedConfig.inputElementSuccessClass),this.inputNode.classList.add(this.mergedConfig.inputElementErrorClass);let o;this.inputRulesMessages[s]?o=this.inputRulesMessages[s]:o=u.messages.get(s),typeof r=="number"?o=o.replace("{0}",r.toString()):Array.isArray(r)&&(o=o.replace("{0}",r[0]),o=o.replace("{1}",r[1])),f||(f=document.createElement(this.mergedConfig.errorElementTag),f.className=this.mergedConfig.errorElementClass,this.inputNode.parentElement.appendChild(f)),f.textContent=o,f.style.height=`${f.scrollHeight}px`,this.invalidRule=s,this.invalidRuleMessage=o;return}return!0}),n&&(this.isValid=!0,this.invalidRule="",this.invalidRuleMessage="",e)){let s=this.inputNode.parentElement.querySelector("."+this.mergedConfig.errorElementClass);s&&this.mergedConfig.errorElementClass==="validation-error-label"?s.style.height="0px":s==null||s.remove(),this.inputNode.classList.remove(this.mergedConfig.inputElementErrorClass),this.inputNode.classList.add(this.mergedConfig.inputElementSuccessClass)}return n}}class L{constructor(e,t){l(this,"formElement");l(this,"inputs",[]);l(this,"mergedConfig");l(this,"submitButton");l(this,"submitEventCallback",e=>{var s,r;this.mergedConfig.disableFormSubmitEvent&&(e.preventDefault(),e.stopImmediatePropagation());let t=()=>({config:{...this.mergedConfig},formElement:this.formElement,submitButton:this.submitButton,inputList:this.inputs.map(a=>a.inputNode),successList:this.inputs.filter(a=>a.isValid).map(a=>a.inputNode),errorList:this.inputs.filter(a=>!a.isValid).map(a=>({element:a.inputNode,message:a.invalidRuleMessage,rule:a.invalidRule}))});this.validate()?(s=this.mergedConfig.submitHandler)==null||s.call(t(),e):((r=this.mergedConfig.invalidHandler)==null||r.call(t(),e),e.preventDefault()),this.mergedConfig.disableFormSubmitEvent});this.formElement=e,this.mergedConfig=t,this.submitButton=this.formElement.querySelector("input[type='submit'], button[type='submit']"),this.init()}init(){this.formElement.querySelectorAll("select, input, textarea").forEach(e=>{let t=new N(e,this.mergedConfig);t.needValidation&&this.inputs.push(t)}),this.formElement.addEventListener("submit",this.submitEventCallback),this.mergedConfig.enableDefaultValidationForm?this.formElement.removeAttribute("novalidate"):this.formElement.setAttribute("novalidate","")}validate(e=!0){let t=!0;return this.inputs.forEach(n=>{n.validate(e)||(t=!1)}),!t&&this.mergedConfig.onSubmitFocusInvalid&&e&&this.formElement.querySelector("."+this.mergedConfig.inputElementErrorClass).focus(),t}removeRules(e,t){for(let n=0;n<this.inputs.length;n++)if(this.inputs[n].inputNode===e){this.inputs[n].removeRules(t);break}}addRules(e,t){for(let n=0;n<this.inputs.length;n++)if(this.inputs[n].inputNode===e){this.inputs[n].addRules(t);break}}destroy(){this.inputs.forEach(e=>{e.destroy()}),this.formElement.removeEventListener("submit",this.submitEventCallback)}}class q{constructor(e,t){l(this,"formWrap");this.formWrap=new L(e,t)}isValidForm(){return this.formWrap.validate(!1)}validate(){this.formWrap.validate()}removeRules(e,t){this.formWrap.removeRules(e,t)}addRules(e,t){this.formWrap.addRules(e,t)}destroy(){this.formWrap.destroy()}}let S={submitHandler(){},invalidHandler(){},debug:!0,inputElementClass:"validation-input",inputElementErrorClass:"validation-input_error",inputElementSuccessClass:"validation-input_success",errorElementClass:"validation-error-label",errorElementTag:"p",onSubmitFocusInvalid:!0,rules:{},messages:{},enableDefaultValidationForm:!1,disableFormSubmitEvent:!1};function g(i,e={}){let t=JSON.parse(JSON.stringify(S)),n=E(t,e);if(n.debug&&!(i instanceof HTMLFormElement))return d("root parameter is not form"),d("root parameter type is "+i),null;if(n.debug){for(let s in n)switch(s){case"submitHandler":case"invalidHandler":typeof n.submitHandler!="function"&&d(`field '${s}' is not function`);break;case"rules":case"messages":typeof n[s]!="object"&&(d(`field '${s}' doesn't object type`),n[s]={});break;case"debug":case"onSubmitFocusInvalid":case"enableDefaultValidationForm":case"disableFormSubmitEvent":typeof n[s]!="boolean"&&d(`field '${s}' doesn't boolean type`);break;case"inputElementClass":case"inputElementSuccessClass":case"errorElementTag":case"errorElementClass":case"inputElementErrorClass":typeof n[s]!="string"&&d(`field '${s}' doesn't boolean type`);break;default:d(`field '${s}' doesn't exist in config`),delete n[s]}for(let s in n.rules)i.querySelector(`[name='${s}']`)||(d(`input with name '${s}' doesn't exist in the document.`),delete n.rules[s]);for(let s in n.messages)i.querySelector(`[name='${s}']`)||(d(`input with name '${s}' doesn't exist in the document.`),delete n.messages[s])}return new q(i,n)}function A(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var V=I,F=/^(?:\w+:)?\/\/(\S+)$/,$=/^localhost[\:?\d]*(?:[^\:?\d]\S*)?$/,x=/^[^\s\.]+\.\S{2,}$/;function I(i){if(typeof i!="string")return!1;var e=i.match(F);if(!e)return!1;var t=e[1];return t?!!($.test(t)||x.test(t)):!1}const w=A(V);u.addRule("required",(i,e,t)=>{if(t instanceof HTMLSelectElement)return!t.selectedOptions[0].hasAttribute("disabled");if(t.getAttribute("type")==="checkbox")return t.checked;if(t.getAttribute("type")==="radio"){let n=document.querySelectorAll(`input[name='${t.getAttribute("name")}']`),s=!1;return n.forEach(r=>{r.checked&&(s=!0)}),s}return!!i},"");u.addRule("minLength",(i,e)=>e<=i.length,"");u.addRule("maxLength",(i,e)=>i.length<=e,"");u.addRule("email",i=>/^[a-zA-Z0-9.!#$%&'*+\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/.test(i),"");u.addRule("url",i=>w(i),"");u.addRule("digits",i=>/^\d+$/.test(i),"");u.addRule("min",(i,e)=>e<=i,"");u.addRule("max",(i,e)=>i<=e,"");u.addRule("date",i=>!/Invalid|NaN/.test(new Date(i).toString()),"");u.addRule("range",(i,e)=>e[0]<=+i&&+i<=e[1],"");window.globalInputValidationNext=u;globalInputValidationNext.addRule("customRule",function(i){return i==="qwe123"},"Value isn't equal to 'qwe123'");let c=g(document.getElementById("form-1"),{submitHandler:function(){console.log("form is submited")},rules:{noExistProp:{range:[3,5],rqeuid:!0},numberInputName:{range:[3,5]},customRuleInput:{required:12,customRule:!0}},dsflsdf:12,messages:{defaultAttrInput:{required:"Required custom message for defaultAttrInput input"},customRuleInput:{required:"Required custom message"},noExistProp:{required:"Custom error message"}},enableDefaultValidationForm:!1,disableFormSubmitEvent:!0}),m=g(document.getElementById("form-2"),{submitHandler:function(){console.log("form is submited"),console.log(m==null?void 0:m.isValidForm())},invalidHandler:function(){console.log("form isn't submited"),console.log(m==null?void 0:m.isValidForm())},disableFormSubmitEvent:!0});c==null||c.removeRules(document.querySelector("#form-1 [name='defaultAttrInput']"),["minLength"]);c==null||c.addRules(document.querySelector("#form-1 [name='defaultInput']"),{rules:{minLength:4,required12:14},messages:{minLength:"custom minLenght message from addRules",dsdf:"12"}});g(document.getElementById("form-4"),{submitHandler:function(){console.log("form is submited"),console.log(m==null?void 0:m.isValidForm())},invalidHandler:function(){console.log("form isn't submited"),console.log(m==null?void 0:m.isValidForm())},rules:{requiredInput:{url:!0}}});
